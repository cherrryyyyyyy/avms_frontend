(function(){var t={8677:function(t,e,a){"use strict";var s=a(66848),l=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},r=[];const i=(t,e)=>{let a;return(...s)=>{a&&clearTimeout(a),a=setTimeout((()=>{t(...s)}),e)}},o=window.ResizeObserver;window.ResizeObserver=class extends o{constructor(t){t=i(t,200),super(t)}};var n={name:"app"},c=n,u=a(81656),d=(0,u.A)(c,l,r,!1,null,null,null),p=d.exports,h=a(15596),m=a.n(h),f=a(64660),v=a.n(f),g=a(23832),_=a.n(g),b=a(94355),C=a.n(b),y=a(8178),w=a.n(y),k=a(24856),x=a.n(k),D=a(11612),$=a.n(D),F=a(88088),S=a.n(F),T=a(29373),A=a.n(T),G=a(95441),P=a.n(G),q=a(83950),L=a.n(q),E=a(16034),M=a.n(E),z=a(74351),I=a.n(z),O=a(41442),j=a.n(O),N=a(70664),B=a.n(N),R=a(69008),U=a.n(R),H=a(7358),V=a.n(H),Q=a(76287),J=a.n(Q),Y=a(55614),K=a.n(Y),W=a(64932),X=a.n(W),Z=a(38296),tt=a.n(Z),et=a(40707),at=a.n(et),st=a(74783),lt=a.n(st),rt=a(84806),it=a.n(rt),ot=a(8900),nt=a.n(ot),ct=a(12025),ut=a.n(ct),dt=a(42525),pt=a.n(dt),ht=a(95125),mt=a.n(ht),ft=a(86272),vt=a.n(ft),gt=a(63797),_t=a.n(gt),bt=a(50353),Ct=a.n(bt),yt=a(23952),wt=a.n(yt),kt=a(60630),xt=a.n(kt),Dt=a(51120),$t=a.n(Dt),Ft=a(28858),St=a.n(Ft),Tt=a(54245),At=a.n(Tt),Gt=a(83715),Pt=a.n(Gt),qt=a(874),Lt=a.n(qt),Et=a(95790),Mt=a.n(Et),zt=a(29881),It=a.n(zt),Ot=a(66063),jt=a.n(Ot),Nt=a(90167),Bt=a.n(Nt),Rt=a(62063),Ut=a.n(Rt),Ht=a(61443),Vt=a.n(Ht),Qt=a(90685),Jt=a.n(Qt),Yt=a(67705),Kt=a.n(Yt),Wt=a(59384),Xt=a.n(Wt),Zt=a(67386),te=a.n(Zt),ee=a(32672),ae=a.n(ee),se=a(94054),le=a.n(se),re=a(65345),ie=a.n(re),oe=a(2179),ne=a.n(oe),ce=a(68082),ue=a.n(ce),de=a(56210),pe=a.n(de),he=a(21275),me=a.n(he),fe=a(74621),ve=a.n(fe),ge=a(29507),_e=a.n(ge),be=a(23436),Ce=a.n(be),ye=a(11362),we=a.n(ye),ke=a(25319),xe=a.n(ke),De=a(88339),$e=a.n(De),Fe=a(19940),Se=a.n(Fe),Te=a(66535),Ae=a.n(Te),Ge=a(61178),Pe=a.n(Ge),qe=a(59237),Le=a.n(qe),Ee=a(84902),Me=a.n(Ee),ze=a(80544),Ie=a.n(ze),Oe=a(62381),je=a.n(Oe),Ne=a(11227),Be=a.n(Ne),Re=a(92736),Ue=a.n(Re),He=a(10406),Ve=a.n(He),Qe=a(6870),Je=a.n(Qe),Ye=a(42916),Ke=a.n(Ye),We=a(31604),Xe=a.n(We),Ze=a(38228),ta=a.n(Ze),ea=a(66782),aa=a.n(ea),sa=a(55235),la=a.n(sa),ra=a(90175),ia=a.n(ra),oa=a(17999),na=a.n(oa);s["default"].use(na()),s["default"].use(ia()),s["default"].use(la()),s["default"].use(aa()),s["default"].use(ta()),s["default"].use(Xe()),s["default"].use(Ke()),s["default"].use(Je()),s["default"].use(Ve()),s["default"].use(Ue()),s["default"].use(Be()),s["default"].use(je()),s["default"].use(Ie()),s["default"].use(Me()),s["default"].use(Le()),s["default"].use(Pe()),s["default"].use(Ae()),s["default"].use(Se()),s["default"].use($e()),s["default"].use(xe()),s["default"].use(we()),s["default"].use(Ce()),s["default"].use(_e()),s["default"].use(ve()),s["default"].use(me()),s["default"].use(pe()),s["default"].use(ue()),s["default"].use(ne()),s["default"].use(ie()),s["default"].use(le()),s["default"].use(ae()),s["default"].use(te()),s["default"].use(Xt()),s["default"].use(Kt()),s["default"].use(Jt()),s["default"].use(Vt()),s["default"].use(Ut()),s["default"].use(Bt()),s["default"].use(jt()),s["default"].use(It()),s["default"].use(Mt()),s["default"].use(Lt()),s["default"].use(Pt()),s["default"].use(At()),s["default"].use(St()),s["default"].use($t()),s["default"].use(xt()),s["default"].use(wt()),s["default"].use(Ct()),s["default"].use(_t()),s["default"].use(vt()),s["default"].use(mt()),s["default"].use(pt()),s["default"].use(ut()),s["default"].use(nt()),s["default"].use(it()),s["default"].use(lt()),s["default"].use(at()),s["default"].use(tt()),s["default"].use(X()),s["default"].use(K()),s["default"].use(J()),s["default"].use(V()),s["default"].use(U()),s["default"].use(B()),s["default"].use(j()),s["default"].use(I()),s["default"].use(M()),s["default"].use(L()),s["default"].use(P()),s["default"].use(A()),s["default"].use(S()),s["default"].use($()),s["default"].use(x()),s["default"].use(w()),s["default"].use(C().directive),s["default"].prototype.$loading=C().service,s["default"].prototype.$msgbox=_(),s["default"].prototype.$alert=_().alert,s["default"].prototype.$confirm=_().confirm,s["default"].prototype.$prompt=_().prompt,s["default"].prototype.$notify=v(),s["default"].prototype.$message=m();var ca,ua,da=a(56178),pa=function(){var t=this,e=t._self._c;return e("div",{staticClass:"layout"},[e("div",{staticClass:"menu"},[e("Menu",{attrs:{is_collapse:t.is_collapse},on:{changeMenu:t.changeMenu}})],1),e("div",{staticClass:"content",class:{small:t.is_collapse}},[e("Content",{attrs:{is_collapse:t.is_collapse}})],1)])},ha=[],ma=function(){var t=this,e=t._self._c;return e("div",[e("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":t.$route.path,"background-color":"#091527","text-color":"#fff","active-text-color":"#ffd04b",router:"",collapse:t.is_collapse}},[e("el-menu-item",{attrs:{index:""}},[e("i",{staticClass:"el-icon-s-operation",on:{click:t.changeMenu}}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("原子组件配置系统")])]),e("el-menu-item",{attrs:{index:"/"}},[e("i",{staticClass:"el-icon-s-home"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("首页")])]),e("el-menu-item",{attrs:{index:"/target/index"}},[e("i",{staticClass:"el-icon-aim"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("目标")])]),e("el-menu-item",{attrs:{index:"/task/index"}},[e("i",{staticClass:"el-icon-postcard"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("任务")])]),e("el-submenu",{attrs:{index:"/strategy"}},[e("template",{slot:"title"},[e("i",{staticClass:"el-icon-location"}),e("span",[t._v("策略管理")])]),e("el-menu-item-group",[e("el-menu-item",{attrs:{index:"/strategy/index"}},[t._v("端口扫描策略")])],1),e("el-menu-item-group",[e("el-menu-item",{attrs:{index:"/pocmethod/index"}},[t._v("POC扫描策略")])],1)],2),e("el-submenu",{attrs:{index:"/resource"}},[e("template",{slot:"title"},[e("i",{staticClass:"el-icon-files"}),e("span",[t._v("资源库")])]),e("el-menu-item-group",[e("el-menu-item",{attrs:{index:"/resource/index"}},[t._v("CVE库资源")])],1),e("el-menu-item-group",[e("el-menu-item",{attrs:{index:"/fingerprints/index"}},[t._v("指纹库资源")])],1),e("el-menu-item-group",[e("el-menu-item",{attrs:{index:"/pocview/index"}},[t._v("POC资源")])],1)],2),e("el-menu-item",{attrs:{index:"/result/index"}},[e("i",{staticClass:"el-icon-document"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("结果")])])],1)],1)},fa=[],va={props:["is_collapse"],methods:{changeMenu(){this.$emit("changeMenu")}}},ga=va,_a=(0,u.A)(ga,ma,fa,!1,null,"fca42160",null),ba=_a.exports,Ca=function(){var t=this,e=t._self._c;return e("div",[e("router-view")],1)},ya=[],wa={},ka=wa,xa=(0,u.A)(ka,Ca,ya,!1,null,null,null),Da=xa.exports,$a={components:{Menu:ba,Content:Da},data(){return{is_collapse:!1}},methods:{changeMenu(){this.is_collapse=!this.is_collapse}}},Fa=$a,Sa=(0,u.A)(Fa,pa,ha,!1,null,"0570448a",null),Ta=Sa.exports,Aa=function(){var t=this,e=t._self._c;return e("div",{staticClass:"clearfix",attrs:{id:"login_wrap"}},[e("div",{attrs:{id:"login"}},[e("h2",{staticClass:"title"},[t._v("登录页")]),e("div",{staticClass:"login--account"},[e("span",[t._v("账号：")]),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.username,expression:"username",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"输入",name:"account"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),e("div",{staticClass:"login--password"},[e("span",[t._v("密码：")]),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.password,expression:"password",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"输入",name:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),e("p",{staticClass:"login--btn"},[e("el-button",{attrs:{id:"loginBtn",type:"primary"},on:{click:t.getLogin}},[t._v("登录")])],1)])])},Ga=[],Pa={},qa=Pa,La=(0,u.A)(qa,Aa,Ga,!1,null,"3ed715a7",null),Ea=La.exports,Ma=function(){var t=this,e=t._self._c;return e("div",[t._m(0),e("div",{staticClass:"wrapper"},[e("el-row",[e("el-col",{attrs:{span:10}},[e("div",{staticClass:"grid-content"},[e("div",{staticClass:"echart",style:t.myChartStyle,attrs:{id:"mychart"}})])]),e("el-col",{attrs:{span:10}},[e("div",{staticClass:"grid-content"},[e("div",{staticClass:"echart",style:t.myChartStyle,attrs:{id:"mychart1"}})])])],1),e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple"},[e("h2",[t._v(" 系统目标列表 ")]),[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.targetData}},[e("el-table-column",{attrs:{prop:"name",label:"目标名称"}}),e("el-table-column",{attrs:{prop:"hosts.length",label:"目标主机数"}}),e("el-table-column",{attrs:{prop:"last_modify_time",label:"最近修改时间"}})],1)]],2)]),e("el-col",{attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple"},[e("h2",[t._v(" 系统任务列表 ")]),[e("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.taskData,"highlight-current-row":""}},[e("el-table-column",{attrs:{type:"index",width:"50"}}),e("el-table-column",{attrs:{property:"name",label:"任务名称",width:"150"}}),e("el-table-column",{attrs:{property:"status",label:"任务状态",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[4==a.row.status?e("p",[t._v("完成")]):1==a.row.status?e("p",[t._v("未开始")]):3==a.row.status?e("p",[t._v("进行中")]):2==a.row.status?e("p",[t._v("准备中")]):t._e()]}}])}),e("el-table-column",{attrs:{property:"alive_hosts",label:"存活主机数",width:"120"}}),e("el-table-column",{attrs:{property:"finished_hosts",label:"目标主机数"}}),e("el-table-column",{attrs:{property:"vul_high",label:"漏洞信息"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:"danger"}},[t._v(t._s(a.row.vul_high))]),e("el-tag",{attrs:{type:"warning"}},[t._v(" "+t._s(a.row.vul_low))])]}}])})],1)]],2)])],1)],1)])},za=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"header"},[e("h3",[t._v(" 首页 ")])])}],Ia=(a(44114),a(89671)),Oa={data(){return{taskData:[],taskDone:0,targetData:[],resultData:[],chart:null,task:[],total:0,Data:[],vuls_high:0,vuls_low:0,chartData:{},currenttaskdata:[{author:"dad",content:4123412,clicks:12312},{author:"mom",content:4112342,clicks:112342}],myChartStyle:{float:"left",width:"100%",height:"400px"}}},mounted(){this.initData()},methods:{initData(){this.getTaskData(),this.getTargetData(),this.getResultData()},async getTaskData(){let t=await this.$api.GetTask(),e=0;for(let a of t.data.data){let t=0,e=0,s=a["name"],l=await this.$api.GetResult({name:s});for(let a of l.data.data){console.log("!!!",a);for(let s of a.vmatch_vuls)s.impact>5&&t++,s.impact<=5&&e++}a["vul_high"]=t,a["vul_low"]=e}this.taskData=t.data.data,console.log("首页任务",this.taskData);for(let a of this.taskData)4==a.status&&e++;this.taskDone=e,console.log(this.taskDone),this.initEchartsTask()},async getTargetData(){let t=await this.$api.GetTarget();console.log("首页目标",t),this.targetData=t.data.data,console.log(this.targetData)},async getResultData(){let t=await this.$api.GetTask();console.log("首页任务统计",t.data.data);for(let e of t.data.data)console.log(e),this.task.push(e);for(let e of this.task){this.result={name:"",start_time:"",end_time:"",status:"",active_host:0,vuls_high:0,vuls_low:0},console.log(e["name"]);let t=e["name"],a=await this.$api.GetResult({name:t});console.log(a),this.result.name=t,this.result.start_time=e["start_time"],this.result.end_time=e["finished_time"],this.result.status=e["status"],this.result.active_host=a.data.data.length;let s=0,l=0;for(let e in a.data.data)for(let t of a.data.data[e].vmatch_vuls)console.log(t),t.impact>5&&s++,t.impact<=5&&l++;this.result.vuls_high=s,this.result.vuls_low=l,this.Data.push(this.result)}for(let e of this.Data)this.vuls_high+=e.vuls_high,this.vuls_low+=e.vuls_low;console.log("侧石",this.Data),this.total=this.Data.length,this.initEchartsResult()},initEchartsTask(){const t={legend:{data:["已完成","未完成"],right:"10%",top:"30%",orient:"vertical"},title:{text:"系统任务统计",top:"0%",left:"center"},series:[{type:"pie",label:{show:!0,formatter:"{b} : {c}"},radius:["40%","70%"],data:[{value:this.taskDone,name:"已完成"},{value:this.taskData.length-this.taskDone,name:"未完成"}]}]};this.myChart=Ia.Ts(document.getElementById("mychart")),this.myChart.setOption(t),window.addEventListener("resize",(()=>{this.myChart.resize()}))},initEchartsResult(){const t={legend:{data:["高危漏洞","低危漏洞"],right:"10%",top:"30%",orient:"vertical"},title:{text:"系统结果统计",top:"0%",left:"center"},series:[{type:"pie",label:{show:!0,formatter:"{b} : {c}"},color:["#FF2E2E","#F6B26B"],radius:["40%","70%"],data:[{value:this.vuls_high,name:"高危漏洞"},{value:this.vuls_low,name:"低危漏洞"}]}]};this.myChart1=Ia.Ts(document.getElementById("mychart1")),this.myChart1.setOption(t),window.addEventListener("resize",(()=>{this.myChart1.resize()}))}}},ja=Oa,Na=(0,u.A)(ja,Ma,za,!1,null,"574cbfd9",null),Ba=Na.exports,Ra=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("div",{staticClass:"form"},[e("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formInline}},[e("el-form-item",{attrs:{label:"组件名称"}},[e("el-input",{attrs:{placeholder:"组件名称"},model:{value:t.formInline.name,callback:function(e){t.$set(t.formInline,"name",e)},expression:"formInline.name"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("查询")])],1)],1)],1),e("div",{staticClass:"group"},[e("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-plus"}},[t._v("添加组件")]),e("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"}},[t._v("批量删除")])],1)]),e("div",{staticClass:"content"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",border:"","header-row-class-name":"active-header"}},[e("el-table-column",{attrs:{type:"selection",width:"40"}}),e("el-table-column",{attrs:{prop:"id",label:"组件编号",width:"180",align:"center"}}),e("el-table-column",{attrs:{prop:"element_class",label:"组件类型",width:"180",align:"center"}}),e("el-table-column",{attrs:{prop:"element_name",label:"组件名称",align:"center","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.handleEdit(a.$index,a.row)}}},[t._v("编辑")]),e("el-button",{attrs:{slot:"reference",size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(e){return t.handleDelete(a.$index,a.row)}},slot:"reference"},[t._v("删除")])]}}])})],1),e("div",{staticClass:"pagination"},[e("Pagination",{attrs:{total:t.total},on:{CurrentChange:t.CurrentChange}})],1)],1)])},Ua=[],Ha=function(){var t=this,e=t._self._c;return e("div",[e("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":10,layout:"total, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)},Va=[],Qa={props:{total:{type:Number,default:100}},methods:{handleSizeChange(t){console.log(`每页 ${t} 条`)},handleCurrentChange(t){console.log(`当前页: ${t}`),this.$emit("CurrentChange",t)}},data(){return{currentPage:1}}},Ja=Qa,Ya=(0,u.A)(Ja,Ha,Va,!1,null,"78c7fcc8",null),Ka=Ya.exports,Wa={components:{Pagination:Ka},data(){return{formInline:{name:""},tableData:[],total:10}},methods:{async onSubmit(){console.log("submit!",this.formInline);let t=this.formInline.name,e=await this.$api.search({search:t});this.tableData=e.data.data,this.total=e.data.length},handleEdit(t,e){console.log(t,e)},handleDelete(t,e){console.log(t,e),this.$confirm("确定删除当前组件?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.deleteElements(e.id)})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},CurrentChange(t){console.log("頁嗎",t),this.elementList(t)},async elementList(t){let e=await this.$api.elementList({page:t});console.log("输出",e,t),this.tableData=e.data.data,this.total=e.data.length},async deleteElements(t){let e=await this.$api.deleteElements({id:t});console.log("删除--------",e.data),200==e.data.status&&this.$message({type:"success",message:"删除成功!"}),this.elementList(1)}},created(){this.elementList(1)}},Xa=Wa,Za=(0,u.A)(Xa,Ra,Ua,!1,null,"7b595baa",null),ts=Za.exports,es=function(){var t=this,e=t._self._c;return e("div",[e("router-view",{attrs:{tableData:t.tableData},on:{Inserttotarget:t.Insert2target,get_target:t.get_target,targetedit:t.target_edit}})],1)},as=[],ss={data(){return{tableData:[],form:{},time:"",fform:{}}},methods:{Gettime(){let t=this,e=(new Date).getFullYear(),a=(new Date).getMonth()+1,s=(new Date).getDate(),l=(new Date).getHours(),r=(new Date).getMinutes(),i=(new Date).getSeconds();l<10&&(l="0"+l),r<10&&(r="0"+r),i<10&&(i="0"+i),t.time=e+"/"+a+"/"+s+" "+l+":"+r+":"+i},Insert2target(t){this.form={name:"",description:"",pl_name:"",hosts:[],create_time:"",last_modify_time:"",hosts_total:0},this.form.name=t.name,this.form.description=t.desc,this.form.pl_name=t.port_list;for(let e of t.hosts)this.form.hosts.push(e.value);this.Gettime(),this.form.create_time=this.time,this.form.last_modify_time=this.time,this.add_target(this.form),alert("submit!")},async add_target(t){let e=await this.$api.CreateTarget(t);console.log("添加",t),200==e.data.status&&this.$message({type:"success",message:"添加成功!"})},async get_target(){let t=await this.$api.GetTarget();console.log("输出????",t),this.tableData=t.data.data,console.log(this.tableData)},target_edit(t){this.edit2api(t)},async edit2api(t){let e=await this.$api.UpdateTarget(t);console.log("修改",t),200==e.data.status&&this.$message({type:"success",message:"添加成功!"})}},created(){this.get_target()}},ls=ss,rs=(0,u.A)(ls,es,as,!1,null,null,null),is=rs.exports,os=function(){var t=this,e=t._self._c;return e("div",[t._v(" 组件更改 ")])},ns=[],cs={},us=cs,ds=(0,u.A)(us,os,ns,!1,null,null,null),ps=ds.exports,hs=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[t._v(" 目标（"+t._s(t.total)+"个） ")])]),e("div",{staticClass:"wrapper"},[e("el-container",[e("el-header",[e("el-row",{staticStyle:{"text-align":"right"}},[e("el-button",{staticClass:"detailed",attrs:{type:"primary"},on:{click:t.CreateNewTarget}},[t._v(" 新增目标 ")]),e("el-select",{staticStyle:{padding:"20px"},attrs:{placeholder:"排序"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),e("el-main",[[e("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"true",data:t.Data,height:"590",border:""}},[e("el-table-column",{attrs:{prop:"name",label:"目标名称",width:"150",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"description",label:"目标描述",width:"270",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"hosts",label:"主机范围",width:"250",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"port_list",label:"端口范围",width:"160",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"create_time",label:"创建时间",width:"250",align:"center"}}),e("el-table-column",{attrs:{prop:"last_modify_time",label:"最近修改时间",width:"250",align:"center"}}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.TargetDetail(a.$index,a.row)}}},[t._v("详情")]),e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.TargetEdit(a.$index,a.row)}}},[t._v("编辑")]),e("el-button",{attrs:{slot:"reference",size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(e){return t.TargetDelete(a.$index,a.row)}},slot:"reference"},[t._v("删除")])]}}])})],1)]],2)],1),e("div",{staticClass:"pagination"},[e("Pagination",{attrs:{total:t.total},on:{CurrentChange:t.CurrentChange}})],1)],1)])},ms=[],fs={components:{Pagination:Ka},props:{tableData:{type:Array,default:()=>[]}},data(){return{options:[{value:"选项1",label:"按目标名称排序"},{value:"选项2",label:"按主机范围排序"},{value:"选项3",label:"按创建时间排序"},{value:"选项4",label:"按修改时间排序"}],total:20,Data:[],page:1}},methods:{CreateNewTarget(){this.$router.push("/target/addtarget")},CurrentChange(t){console.log("頁嗎",t),this.targetList(t),this.page=t},async targetList(t){let e=await this.$api.GetTarget();this.Data=e.data.data.slice(10*(t-1),10*t),console.log("侧石",this.Data,t,e),this.total=e.data.data.length},TargetDetail(t,e){console.log(t,e),t+=10*(this.page-1),this.showdetail(t)},TargetDelete(t,e){console.log(t,e),console.log(e.name),this.$confirm("确定删除当前目标?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.deleteTarget(e.name)})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},TargetEdit(t,e){console.log(t,e),t+=10*(this.page-1),this.showedit(t)},showedit(t){this.$router.push({path:"/target/targetedit",query:{index:t}})},async deleteTarget(t){let e=await this.$api.DeleteTarget({name:t});console.log("删除--------",e.data),200==e.data.status&&this.$message({type:"success",message:"删除成功!"}),this.targetList(1)},showdetail(t){this.$router.push({path:"/target/targetdetail",query:{index:t}})}},created(){this.targetList(1),console.log("what???"),this.total=this.tableData.length}},vs=fs,gs=(0,u.A)(vs,hs,ms,!1,null,"40eaec6f",null),_s=gs.exports,bs=function(){var t=this,e=t._self._c;return e("div",[e("router-view",{attrs:{tableData:t.tableData},on:{Inserttotarget:t.Insert2target,ChangeTask:t.ChangeTask}})],1)},Cs=[],ys={data(){return{tableData:"",form:{},time:""}},methods:{Gettime(){let t=this,e=(new Date).getFullYear(),a=(new Date).getMonth()+1,s=(new Date).getDate(),l=(new Date).getHours(),r=(new Date).getMinutes(),i=(new Date).getSeconds();l<10&&(l="0"+l),r<10&&(r="0"+r),i<10&&(i="0"+i),t.time=e+"/"+a+"/"+s+" "+l+":"+r+":"+i},Insert2target(t){this.form={name:"",description:"",type:"",schedule_time:"",tgt_name:"",asmethod:""},this.form.name=t.name,this.form.description=t.description,this.form.type=t.type,this.form.asmethod=t.asmethod,this.form.tgt_name=t.target,"schedule"==t.type&&(this.form.schedule_time=t.date1+" "+t.date2),this.add_task(this.form),alert("submit!")},async add_task(t){let e=await this.$api.CreateTask(t);console.log("添加任务",t),200==e.data.status&&this.$message({type:"success",message:"添加成功!"})},ChangeTask(t){console.log(t.task_id),this.tableData[t.task_id-1].task_name=t.task_name,this.tableData[t.task_id-1].task_describe=t.task_describe,this.tableData[t.task_id-1].task_target=t.task_target,this.tableData[t.task_id-1].active_scanning_Methods=t.active_scanning_Methods,this.tableData[t.task_id-1].task_type=t.task_type,this.tableData[t.task_id-1].scheduling_time=t.date1+" "+t.date2,this.Gettime(),this.tableData[t.task_id-1].last_change_time=this.time,alert("change!")}},created(){this.$store.commit("saveTaskData",this.tableData)}},ws=ys,ks=(0,u.A)(ws,bs,Cs,!1,null,"493ca80c",null),xs=ks.exports,Ds=function(){var t=this,e=t._self._c;return e("div",[e("div",[e("router-view",{attrs:{tableData:t.tableData,hostData:t.hostData}})],1)])},$s=[],Fs={data(){return{tableData:"",hostData:"",form:{},time:""}},methods:{Gettime(){let t=this,e=(new Date).getFullYear(),a=(new Date).getMonth()+1,s=(new Date).getDate(),l=(new Date).getHours(),r=(new Date).getMinutes(),i=(new Date).getSeconds();l<10&&(l="0"+l),r<10&&(r="0"+r),i<10&&(i="0"+i),t.time=e+"/"+a+"/"+s+" "+l+":"+r+":"+i},Insert2target(t){this.form={task_id:0,task_name:"",task_describe:"",task_target:"",active_scanning_Methods:"",task_type:"",scheduling_time:"",create_time:"",last_change_time:"",task_status:"",task_progress:0},this.form.task_id=this.tableData.length+1,this.form.task_name=t.name,this.form.task_describe=t.desc,this.form.task_target=t.target,this.form.active_scanning_Methods=t.scan_method,this.form.task_type=t.class,this.form.scheduling_time=t.date1+" "+t.date2,this.Gettime(),this.form.create_time=this.time,this.form.last_change_time=this.time,this.tableData.push(this.form),alert("submit!")}}},Ss=Fs,Ts=(0,u.A)(Ss,Ds,$s,!1,null,"089d32b7",null),As=Ts.exports,Gs=function(){var t=this;t._self._c;return t._m(0)},Ps=[function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[t._v(" 管理页面顶部 ")]),e("div",{staticClass:"wrapper"},[e("h2",[t._v("管理")])])])}],qs={},Ls=qs,Es=(0,u.A)(Ls,Gs,Ps,!1,null,"7f00889f",null),Ms=Es.exports,zs=function(){var t=this,e=t._self._c;return e("div",[e("router-view")],1)},Is=[],Os={data(){return{}},methods:{}},js=Os,Ns=(0,u.A)(js,zs,Is,!1,null,null,null),Bs=Ns.exports,Rs=function(){var t=this,e=t._self._c;return e("div",[e("router-view",{on:{Inserttopl:t.Insert2pl,strategyedit:t.strategy_edit}})],1)},Us=[],Hs={data(){return{form:{}}},methods:{Insert2pl(t){this.form={name:"",description:"",tcp_ports:"",udp_ports:""},this.form.name=t.name,this.form.description=t.description,this.form.tcp_ports=t.tcp_ports,this.form.udp_ports=t.udp_ports,this.add_pl(this.form),alert("submit!")},async add_pl(t){let e=await this.$api.CreatePortList(t);console.log("添加端口策略",t),200==e.data.status&&this.$message({type:"success",message:"添加成功!"})},strategy_edit(t){this.editstrategy(t)},async editstrategy(t){let e=await this.$api.UpdatePortList(t);console.log("修改",t),200==e.data.status&&this.$message({type:"success",message:"添加成功!"})}}},Vs=Hs,Qs=(0,u.A)(Vs,Rs,Us,!1,null,null,null),Js=Qs.exports,Ys=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 新增目标 ")],1)]),e("el-header"),e("el-header"),e("div",{staticClass:"wrapper"},[e("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{width:"1300px"},attrs:{model:t.ruleForm,rules:t.rules,"label-width":"200px"}},[e("el-form-item",{attrs:{label:"目标名称",prop:"name"}},[e("el-input",{model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),e("el-form-item",{attrs:{label:"目标描述",prop:"desc"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.desc,callback:function(e){t.$set(t.ruleForm,"desc",e)},expression:"ruleForm.desc"}})],1),t._l(t.ruleForm.hosts,(function(a,s){return e("el-form-item",{key:a.key,attrs:{label:"主机"+s,prop:"hosts."+s+".value",rules:{required:!0,message:"域名不能为空",trigger:"blur"}}},[e("el-input",{model:{value:a.value,callback:function(e){t.$set(a,"value",e)},expression:"host.value"}}),e("el-button",{on:{click:function(e){return e.preventDefault(),t.removeHost(a)}}},[t._v("删除")])],1)})),e("el-form-item",[e("el-button",{on:{click:t.addHost}},[t._v("新增域名")])],1),e("el-form-item",{attrs:{label:"端口范围",prop:"port_list"}},[e("el-select",{attrs:{placeholder:"请选择端口范围"},model:{value:t.ruleForm.port_list,callback:function(e){t.$set(t.ruleForm,"port_list",e)},expression:"ruleForm.port_list"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.lable,value:t.value}})})),1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm",t.ruleForm)}}},[t._v("创建")]),e("el-button",{on:{click:function(e){return t.resetForm("ruleForm")}}},[t._v("重置")])],1)],2)],1)],1)},Ks=[],Ws={data(){return{ruleForm:{name:"",port_list:"",hosts:[{value:""}],desc:""},ddata:[],options:[],rules:{name:[{required:!0,message:"请输入目标名称",trigger:"blur"}],port_list:[{required:!0,message:"请选择端口范围",trigger:"change"}],hosts:[{required:!0,message:"请填写主机范围",trigger:"blur"}],desc:[{required:!0,message:"请填写目标描述",trigger:"blur"}]},form:{}}},methods:{removeHost(t){var e=this.ruleForm.hosts.indexOf(t);-1!==e&&this.ruleForm.hosts.splice(e,1)},addHost(){console.log(Date.now()),this.ruleForm.hosts.push({value:"",key:Date.now()})},Goback(){this.$router.push("/target/index")},submitForm(t,e){console.log(e.hosts),this.$refs[t].validate((t=>{if(!t)return console.log("error submit!!"),!1;this.$emit("Inserttotarget",e),alert("submit!")})),this.Goback()},resetForm(t){this.$refs[t].resetFields()},async getoptions(){let t=await this.$api.GetPorts();this.ddata=t.data.data,console.log(this.$store.state.TargetData),this.ddata.forEach((t=>{this.options.push({lable:t.name,value:t.name})}))}},created(){this.getoptions()}},Xs=Ws,Zs=(0,u.A)(Xs,Ys,Ks,!1,null,"7f383ac8",null),tl=Zs.exports,el=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 目标详情 ")],1)]),e("div",{staticClass:"wrapper"},[e("el-descriptions",{attrs:{column:"2",border:""}},[e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("名称")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data[t.$route.query.index].name)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("ID")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.id[t.$route.query.index])+" ")])]),e("el-descriptions-item",{attrs:{contentStyle:{width:"1000px"}}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("描述")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data[t.$route.query.index].description)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("创建时间")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data[t.$route.query.index].create_time)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("目标范围")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data[t.$route.query.index].hosts)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("上次修改时间")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data[t.$route.query.index].last_modify_time)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("目标数量")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data[t.$route.query.index].hosts_total)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("端口范围")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data[t.$route.query.index].port_list)+" ")])])],1)],1)])},al=[],sl={methods:{Goback(){this.$router.push("/target/index")},async gettarget(){let t=await this.$api.GetTarget();console.log(t),this.Data=t.data.data,this.id=t.data.id}},props:{tableData:{type:Array,default:()=>[]}},data(){return{Data:this.tableData,id:[]}},created(){this.gettarget()}},ll=sl,rl=(0,u.A)(ll,el,al,!1,null,"9b2c787c",null),il=rl.exports,ol=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 任务详情 ")],1)]),e("div",{staticClass:"wrapper"},[e("el-descriptions",{attrs:{column:"2",border:""}},[e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("名称")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data.name)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("ID")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data.id)+" ")])]),e("el-descriptions-item",{attrs:{contentStyle:{width:"1000px"}}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("描述")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data.description)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("创建时间")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data.create_time)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("目标")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data.target)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("上次修改时间")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data.last_modifid_time)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("扫描次序")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data.type)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("活跃扫描方法")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data.alive_scan_method)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("类型")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data.type)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("调度时间")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data.scheduling_time)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("任务状态")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.Data.status)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("任务进度")]),e("div",{staticClass:"fontClass"},[[e("el-progress",{attrs:{"text-inside":!0,"stroke-width":26,percentage:1==t.Data.status?0:2==t.Data.status?25:3==t.Data.status?60:4==t.Data.status?100:0}})]],2)])],1)],1)])},nl=[],cl={methods:{Goback(){this.$router.push("/task/index")}},props:{tableData:{type:Array,default:()=>[]}},data(){return{Data:this.$route.query.index}},created(){console.log(this.Data)}},ul=cl,dl=(0,u.A)(ul,ol,nl,!1,null,"c07815be",null),pl=dl.exports,hl=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[t._v(" 任务("+t._s(t.total)+"个) ")])]),e("div",{staticClass:"wrapper"},[e("el-container",[e("el-header",[e("el-row",{staticStyle:{"text-align":"right"}},[e("el-button",{staticClass:"detailed",attrs:{type:"primary"},on:{click:t.CreateNewTask}},[t._v(" 新增任务 ")]),e("el-select",{staticStyle:{padding:"20px"},attrs:{placeholder:"排序"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),e("el-main",[[e("el-table",{key:t.itemKey,staticStyle:{width:"100%"},attrs:{stripe:"true",data:t.Data,height:"590",border:""}},[e("el-table-column",{attrs:{prop:"name",label:"任务名称",width:"150",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"description",label:"任务描述",width:"200",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"target",label:"任务目标",width:"120",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"asmethod",label:"活跃扫描方法",width:"110",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"type",label:"任务类型",width:"130",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"schedule_time",label:"调度时间",width:"120",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"create_time",label:"创建时间",width:"120",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"last_modifid_time",label:"最近修改时间",width:"120",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"status",label:"任务状态",width:"120",align:"center","show-overflow-tooltip":"true"},scopedSlots:t._u([{key:"default",fn:function(a){return[4==a.row.status?e("p",[t._v("完成")]):1==a.row.status?e("p",[t._v("未开始")]):3==a.row.status?e("p",[t._v("进行中")]):2==a.row.status?e("p",[t._v("准备中")]):t._e()]}}])}),e("el-table-column",{attrs:{prop:"progress",label:"任务进度",width:"100",align:"center","show-overflow-tooltip":"true"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("el-progress",{attrs:{"text-inside":!0,"stroke-width":26,percentage:1==t.row.status?0:2==t.row.status?25:3==t.row.status?60:4==t.row.status?100:0}})]}}])}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-check"},on:{click:function(e){return t.TaskStart(a.$index,a.row)}}},[t._v("启动")]),e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.TaskDetail(a.$index,a.row)}}},[t._v("详情")]),e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.TaskChange(a.$index,a.row)}}},[t._v("编辑")]),e("el-button",{attrs:{slot:"reference",size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(e){return t.TaskDelete(a.$index,a.row)}},slot:"reference"},[t._v("删除")])]}}])})],1)]],2)],1),e("div",{staticClass:"pagination"},[e("Pagination",{attrs:{total:t.total},on:{CurrentChange:t.CurrentChange}})],1)],1)])},ml=[],fl={components:{Pagination:Ka},props:{tableData:{type:Array,default:()=>[]}},data(){return{options:[{value:"选项1",label:"按任务名称排序"},{value:"选项2",label:"按调度时间排序"},{value:"选项3",label:"按创建时间排序"},{value:"选项4",label:"按修改时间排序"}],current_page:1,itemKey:0,total:20,Data:this.tableData}},methods:{CreateNewTask(){this.$router.push("/task/addtask")},CurrentChange(t){console.log("頁嗎",t),this.taskList(t),this.current_page=t},async taskList(t){let e=await this.$api.GetTask();this.Data=e.data.data.slice(10*(t-1),10*t),console.log("侧石",this.Data,t,e),this.total=e.data.data.length},async taskList1(){let t=await this.$api.GetTask();this.Data=t.data.data.slice(0,10)},TaskDetail(t,e){console.log(t,e),this.showdetail(e)},showdetail(t){this.$router.push({path:"/task/taskdetail",query:{index:t}})},TaskChange(t,e){console.log(t,e),this.showchange(e)},showchange(t){this.$router.push({path:"/task/taskchange",query:{index:t}})},TaskDelete(t,e){console.log(t,e),console.log(e.name),this.$confirm("确定删除当前目标?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.delete_task(e.name)})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},async delete_task(t){let e=await this.$api.DeleteTask({name:t});console.log("删除--------",e.data),200==e.data.status&&this.$message({type:"success",message:"删除成功!"}),this.taskList(1)},TaskStart(t,e){console.log(t,e),this.start_task(e.name)},async start_task(t){let e=await this.$api.StartTask({name:t});console.log(e)}},created(){this.taskList(1),this.total=this.tableData.length},mounted(){this.timer=setInterval(this.taskList1,3e3)},beforeDestroy(){clearInterval(this.timer)}},vl=fl,gl=(0,u.A)(vl,hl,ml,!1,null,"48fcad1f",null),_l=gl.exports,bl=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 新增任务 ")],1)]),e("el-header"),e("el-header"),e("div",{staticClass:"wrapper"},[e("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{width:"1000px"},attrs:{model:t.ruleForm,rules:t.rules,options:t.options,alive_scan_methods:t.alive_scan_methods,"label-width":"200px"}},[e("el-form-item",{attrs:{label:"名称",prop:"name",required:""}},[e("el-input",{model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),e("el-form-item",{attrs:{label:"描述",prop:"description",required:""}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.description,callback:function(e){t.$set(t.ruleForm,"description",e)},expression:"ruleForm.description"}})],1),e("el-form-item",{attrs:{label:"目标",prop:"target"}},[e("el-select",{attrs:{placeholder:"请选择测试目标",required:""},model:{value:t.ruleForm.target,callback:function(e){t.$set(t.ruleForm,"target",e)},expression:"ruleForm.target"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.lable,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"活页扫描方法",prop:"asmethod",required:""}},[e("el-select",{attrs:{placeholder:"请选择扫描方法"},model:{value:t.ruleForm.asmethod,callback:function(e){t.$set(t.ruleForm,"asmethod",e)},expression:"ruleForm.asmethod"}},t._l(t.alive_scan_methods,(function(t){return e("el-option",{key:t.value,attrs:{label:t.lable,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"类型",prop:"type",required:""}},[e("el-select",{attrs:{placeholder:"请选择类型"},model:{value:t.ruleForm.type,callback:function(e){t.$set(t.ruleForm,"type",e)},expression:"ruleForm.type"}},[e("el-option",{attrs:{label:"按需",value:"on_demand"}}),e("el-option",{attrs:{label:"调度",value:"schedule"}})],1)],1),t.IsShow(t.ruleForm.type)?e("el-form-item",{attrs:{label:"调度时间",required:""}},[e("el-col",{attrs:{span:11}},[e("el-form-item",{attrs:{prop:"date1"}},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:t.ruleForm.date1,callback:function(e){t.$set(t.ruleForm,"date1",e)},expression:"ruleForm.date1"}})],1)],1),e("el-col",{staticClass:"line",attrs:{span:2}},[t._v("-")]),e("el-col",{attrs:{span:11}},[e("el-form-item",{attrs:{prop:"date2"}},[e("el-time-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"选择时间","value-format":"hh:mm:ss"},model:{value:t.ruleForm.date2,callback:function(e){t.$set(t.ruleForm,"date2",e)},expression:"ruleForm.date2"}})],1)],1)],1):t._e(),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm",t.ruleForm)}}},[t._v("创建")]),e("el-button",{on:{click:function(e){return t.resetForm("ruleForm")}}},[t._v("重置")])],1)],1)],1)],1)},Cl=[],yl={data(){return{ruleForm:{name:"",target:"",description:"",date1:"",date2:"",type:"",asmethod:""},options:[],alive_scan_methods:[],rules:{name:[{required:!0,message:"请输入组件名称",trigger:"blur"}],type:[{required:!0,message:"请选择端口范围",trigger:"change"}],alive_scan_method:[{required:!0,message:"请选择扫描方法",trigger:"change"}],target:[{required:!0,message:"请选择测试目标",trigger:"change"}],description:[{required:!0,message:"请填写组件描述",trigger:"blur"}],date1:[{required:!0,message:"请选择日期",trigger:"change"}],date2:[{required:!0,message:"请选择时间",trigger:"change"}]},form:{}}},methods:{Goback(){this.$router.push("/task/index")},IsShow(t){return"schedule"==t},submitForm(t,e){console.log(new Date),this.$refs[t].validate((t=>{if(!t)return console.log("error submit!!"),!1;this.$emit("Inserttotarget",e),alert("submit!")})),this.Goback()},resetForm(t){this.$refs[t].resetFields(),console.log(this.options)},async get_alive_scan_methods(){let t=await this.$api.GetActiveMethods();console.log(t);let e=t.data.data;e.forEach((t=>{this.alive_scan_methods.push({lable:t.name,value:t.value})}))},async getoptions(){let t=await this.$api.GetTarget(),e=t.data.data;e.forEach((t=>{this.options.push({lable:t.name,value:t.name})}))}},created(){console.log("chaungjian"),this.getoptions(),this.get_alive_scan_methods()}},wl=yl,kl=(0,u.A)(wl,bl,Cl,!1,null,"51bd7d70",null),xl=kl.exports,Dl=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[t._v(" 任务("+t._s(t.total)+"个) ")])]),e("div",{staticClass:"wrapper"},[e("el-container",[e("el-header",[e("el-row",{staticStyle:{"text-align":"right"}},[e("el-select",{staticStyle:{padding:"20px"},attrs:{placeholder:"刷新频率"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.frequencys,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),e("el-button",{attrs:{type:"primary",icon:"el-icon-refresh-left"}}),e("el-select",{staticStyle:{padding:"20px"},attrs:{placeholder:"排序"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),e("el-main",[[e("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"true",data:t.Data,height:"590",border:""}},[e("el-table-column",{attrs:{prop:"name",label:"任务名称",width:"150",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"start_time",label:"启动时间",width:"250",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"end_time",label:"结束时间",width:"250",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"status",label:"任务状态",width:"150",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"active_host",label:"活跃主机",width:"120",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"vuls",label:"漏洞数量",width:"120",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.ResultDetail(a.$index,a.row)}}},[t._v("详情")]),e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.handleEdit(a.$index,a.row)}}},[t._v("报告")]),e("el-button",{attrs:{slot:"reference",size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(e){return t.handleDelete(a.$index,a.row)}},slot:"reference"},[t._v("删除")])]}}])})],1)]],2)],1),e("div",{staticClass:"pagination"},[e("Pagination",{attrs:{total:t.total},on:{CurrentChange:t.CurrentChange}})],1)],1)])},$l=[],Fl={components:{Pagination:Ka},data(){return{options:[{value:"选项1",label:"按任务名称排序"},{value:"选项2",label:"按调度时间排序"},{value:"选项3",label:"按创建时间排序"},{value:"选项4",label:"按修改时间排序"}],frequencys:[{value:"选项1",label:"每30s刷新一次"},{value:"选项2",label:"每15s刷新一次"},{value:"选项3",label:"每5s刷新一次"}],total:0,Data:[],result:[],task:[],page:1}},methods:{CurrentChange(t){console.log("頁嗎",t),this.resultList(t),this.page=t},async resultList(t){let e=await this.$api.GetTask();console.log("任务",e,t);for(let a of e.data.data)this.task.push(a);console.log(this.task);for(let a of this.task){this.result={name:"",start_time:"",end_time:"",status:"",active_host:0,vuls:0},console.log(a["name"]);let e=a["name"],s=await this.$api.GetResult({name:e});console.log(s),this.result.name=e,this.result.start_time=a["start_time"],this.result.end_time=a["finished_time"],this.result.status="完成",this.result.active_host=s.data.data.length;let l=0;for(let t in s.data.data)console.log(s.data.data[t]),l+=s.data.data[t].vmatch_vuls.length;this.result.vuls=l,this.Data.push(this.result),console.log(t,s)}this.Data=this.Data.slice(10*(t-1),10*t),console.log("侧石",this.Data,t),this.total=this.Data.length},ResultDetail(t,e){console.log(t,e),t+=10*(this.page-1),this.showdetail(e)},showdetail(t){this.$router.push({path:"/result/resultdetail",query:{index:t}})}},created(){this.resultList(1),this.total=this.tableData.length}},Sl=Fl,Tl=(0,u.A)(Sl,Dl,$l,!1,null,"57ef0059",null),Al=Tl.exports,Gl=function(){var t=this,e=t._self._c;return e("div",[e("router-view",{attrs:{hostD:t.hostD,taskD:t.taskD}})],1)},Pl=[],ql={data(){return{activeIndex:"1",Data:[],host:[],hostD:{},taskD:{},name:"",total:0,hostDD:[],task_time:0,id:"",page:1}},computed:{timeDifferenceInMinutes(){const t=this.getTimeDifference(this.Data[this.$route.query.index].start_time,this.Data[this.$route.query.index].finished_time);return t/1e3/60}},methods:{async hostList(){let t=this.$route.query.index.name,e=await this.$api.QueryTask({name:t}),a=await this.$api.GetResult({name:t});console.log("结果:",a),this.taskD=e.data.data[0],this.hostD=a.data.data,console.log("!!!",this.hostD,this.taskD),this.Gonext()},Goback(){this.$router.push("/result/index")},Gonext(){this.$router.push("/result/resultdetail/taskoverview")}},created(){this.hostList()}},Ll=ql,El=(0,u.A)(Ll,Gl,Pl,!1,null,"2f18105a",null),Ml=El.exports,zl=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 任务结果 ")],1)]),e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.$route.path,mode:"horizontal",router:"","background-color":"#409eff","text-color":"#fff","active-text-color":"#ffd04b"}},[e("el-menu-item",{attrs:{index:"/result/resultdetail/taskoverview"}},[t._v("任务概况")]),e("el-menu-item",{attrs:{index:"/result/resultdetail/assetstatistics"}},[t._v("目标信息")]),e("el-menu-item",{attrs:{index:"/result/resultdetail/hostvulnerability"}},[t._v("主机漏洞")])],1),e("div",{staticClass:"wrapper"},[e("el-descriptions",{attrs:{column:"2",border:""}},[e("el-descriptions-item",{attrs:{labelStyle:"width: 150px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("扫描目标数")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.taskData.finished_hosts)+" ")])]),e("el-descriptions-item",{attrs:{labelStyle:"width: 150px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("任务状态")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.taskData.status)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("存活目标列表")]),e("div",{staticClass:"fontClass"},[e("el-card",{staticClass:"box-card"},t._l(this.hostData,(function(a){return e("div",{key:a,staticClass:"text item"},[t._v(" "+t._s(a.ip)+" ")])})),0)],1)]),e("el-descriptions-item",{attrs:{labelStyle:"width: 125px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("存活目标数")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.hostData.length)+" ")])]),e("el-descriptions-item",{attrs:{labelStyle:"width: 125px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("存活探测方式")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.alive_scan_methods[this.taskData.alive_scan_method].label)+" ")])]),e("el-descriptions-item",{attrs:{labelStyle:"width: 125px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("调度类型")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.taskData.type)+" ")])]),e("el-descriptions-item",{attrs:{labelStyle:"width: 125px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("开始时间")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.taskData.start_time)+" ")])]),e("el-descriptions-item",{attrs:{labelStyle:"width: 125px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("结束时间")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.taskData.finished_time)+" ")])])],1)],1)],1)},Il=[],Ol={data(){return{hostData:this.hostD,taskData:this.taskD,alive_scan_methods:[]}},props:{hostD:{type:Array,default:()=>[]},taskD:{type:Array,default:()=>[]}},methods:{Goback(){this.$router.push("/result/index")},async getscanmethod(){let t=await this.$api.GetActiveMethods();console.log(t);let e=t.data.data;e.forEach((t=>{this.alive_scan_methods.push({label:t.name,value1:t.seq,value2:t.parameter})}))}},created(){this.getscanmethod(),console.log("chuang!!",this.hostData,this.taskData,this.alive_scan_methods)}},jl=Ol,Nl=(0,u.A)(jl,zl,Il,!1,null,"757ccdc2",null),Bl=Nl.exports,Rl=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 任务结果 ")],1)]),e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.$route.path,mode:"horizontal",router:"","background-color":"#409eff","text-color":"#fff","active-text-color":"#ffd04b"}},[e("el-menu-item",{attrs:{index:"/result/resultdetail/taskoverview"}},[t._v("任务概况")]),e("el-menu-item",{attrs:{index:"/result/resultdetail/assetstatistics"}},[t._v("目标信息")]),e("el-menu-item",{attrs:{index:"/result/resultdetail/hostvulnerability"}},[t._v("主机漏洞")])],1),e("div",{staticClass:"wrapper"},[e("el-row",[e("el-col",{attrs:{span:6}},[e("div",{staticClass:"grid-content bg-purple"},[[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.hostData,height:"100%",border:"","highlight-current-row":""},on:{"current-change":t.handleCurrentChange}},[e("el-table-column",{attrs:{prop:"ip",label:"主机",width:"210"}}),e("el-table-column",{attrs:{prop:"vmatch_vuls.length",label:"漏洞数量",width:"205"}})],1)]],2)]),e("el-col",{attrs:{span:18}},[e("div",{staticClass:"grid-content bg-purple-light"},[e("h2",[t._v(" "+t._s(this.hostSelectData.ip)+" ")]),e("el-descriptions",{attrs:{column:"1",border:"",labelStyle:"width: 156px"}},[e("el-descriptions-item",{attrs:{labelStyle:"width: 156px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("主机名")]),e("div",{staticClass:"fontClass"},[e("el-card",{staticClass:"box-card"},t._l(this.hostSelectData.hostnames,(function(a){return e("div",{key:a,staticClass:"text item"},[t._v(" "+t._s(a.name)+" ")])})),0)],1)]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("mac")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.hostSelectData.mac)+" ")])]),e("el-descriptions-item",{attrs:{labelStyle:"min-width:156px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("操作系统")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.hostSelectData.os.name)+" ")])]),e("el-descriptions-item",{attrs:{labelStyle:"width: 156px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("端口")]),e("div",{staticClass:"fontClass"},[e("el-card",{staticClass:"box-card"},t._l(this.hostSelectData.ports_opened,(function(a){return e("div",{key:a,staticClass:"text item"},[t._v(" "+t._s(a.port_id)+" ")])})),0)],1)]),e("el-descriptions-item",{attrs:{labelStyle:"width: 156px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("端口详细信息")]),e("div",{staticClass:"fontClass"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:this.hostSelectData.ports_detail,height:"100%",border:"","highlight-current-row":""}},[e("el-table-column",{attrs:{prop:"port_id",label:"端口号","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"banners",label:"服务名称","show-overflow-tooltip":"true"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(Object.keys(e.row.banners)[0])+" ")]}}])}),e("el-table-column",{attrs:{prop:"value.summary",label:"服务版本","show-overflow-tooltip":"true"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.banners[Object.keys(e.row.banners)[0]].version)+" ")]}}])})],1)],1)])],1)],1)])],1)],1)],1)},Ul=[],Hl={data(){return{hostData:this.hostD,hostSelectData:[]}},props:{hostD:{type:Array,default:()=>[]}},methods:{Goback(){this.$router.push("/result/index")},handleCurrentChange(t){this.hostSelectData=t,console.log(this.hostSelectData)}},created(){console.log("chuang!!",this.hostData),this.hostSelectData=this.hostData[0]}},Vl=Hl,Ql=(0,u.A)(Vl,Rl,Ul,!1,null,"7305b58b",null),Jl=Ql.exports,Yl=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 任务结果 ")],1)]),e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.$route.path,mode:"horizontal",router:"","background-color":"#409eff","text-color":"#fff","active-text-color":"#ffd04b"}},[e("el-menu-item",{attrs:{index:"/result/resultdetail/taskoverview"}},[t._v("任务概况")]),e("el-menu-item",{attrs:{index:"/result/resultdetail/assetstatistics"}},[t._v("目标信息")]),e("el-menu-item",{attrs:{index:"/result/resultdetail/hostvulnerability"}},[t._v("主机漏洞")])],1),e("div",{staticClass:"wrapper"},[e("el-row",[e("el-col",{attrs:{span:6}},[e("div",{staticClass:"grid-content bg-purple"},[[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.vulData,height:"100%",border:"","highlight-current-row":"","default-sort":{prop:"impact",order:"descending"}},on:{"current-change":t.handleCurrentChange}},[e("el-table-column",{attrs:{prop:"impact",label:"严重程度","show-overflow-tooltip":"true",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:a.row.impact>=5?"danger":a.row.impact<5?"warning":"info"}},[t._v(t._s(a.row.impact))])]}}])}),e("el-table-column",{attrs:{prop:"value.summary",label:"漏洞名称","show-overflow-tooltip":"true"}})],1)]],2)]),e("el-col",{attrs:{span:18}},[e("div",{staticClass:"grid-content bg-purple-light"},[e("el-descriptions",{attrs:{column:"1",border:""}},[e("el-descriptions-item",{attrs:{labelStyle:"width: 150px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("所属主机")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.hostSelectData.lable)+" ")])]),e("el-descriptions-item",{attrs:{labelStyle:"width: 150px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("漏洞名称")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.hostSelectData.value.summary)+" ")])]),e("el-descriptions-item",{attrs:{labelStyle:"width: 150px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("cvss评分")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.hostSelectData.value.cvss)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("cve")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.hostSelectData.value.id)+" ")])]),e("el-descriptions-item",{attrs:{labelStyle:"width: 125px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("参考链接")]),e("div",{staticClass:"fontClass"},[e("el-card",{staticClass:"box-card"},t._l(this.hostSelectData.value.references,(function(a){return e("div",{key:a,staticClass:"text item"},[t._v(" "+t._s(a)+" ")])})),0)],1)])],1)],1)])],1)],1)],1)},Kl=[],Wl={data(){return{hostData:this.hostD,hostSelectData:[],vulData:[]}},props:{hostD:{type:Array,default:()=>[]}},methods:{Goback(){this.$router.push("/result/index")},handleCurrentChange(t){this.hostSelectData=t,console.log("selectData!!!",this.hostSelectData)},vulinit(){this.hostData.forEach((t=>{let e=t.ip;t.vmatch_vuls.forEach((t=>{this.vulData.push({lable:e,value:t,impact:t.impact})}))})),console.log("vulbianli",this.vulData)}},created(){console.log("chuang!!",this.hostData),this.vulinit(),this.hostSelectData=this.vulData[0],console.log("vul xinxi",this.hostSelectData)}},Xl=Wl,Zl=(0,u.A)(Xl,Yl,Kl,!1,null,"395f5f73",null),tr=Zl.exports,er=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 修改任务 ")],1)]),e("el-header"),e("el-header"),e("div",{staticClass:"wrapper"},[e("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{width:"1000px"},attrs:{model:t.ruleForm,rules:t.rules,options:t.options,"label-width":"200px"}},[e("el-form-item",{attrs:{label:"名称",prop:"task_name"}},[e("el-input",{model:{value:t.ruleForm.task_name,callback:function(e){t.$set(t.ruleForm,"task_name",e)},expression:"ruleForm.task_name"}})],1),e("el-form-item",{attrs:{label:"描述",prop:"task_describe"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.task_describe,callback:function(e){t.$set(t.ruleForm,"task_describe",e)},expression:"ruleForm.task_describe"}})],1),e("el-form-item",{attrs:{label:"目标",prop:"task_target"}},[e("el-select",{attrs:{placeholder:"请选择测试目标"},model:{value:t.ruleForm.task_target,callback:function(e){t.$set(t.ruleForm,"task_target",e)},expression:"ruleForm.task_target"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.lable,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"活页扫描方法",prop:"active_scanning_Methods"}},[e("el-select",{attrs:{placeholder:"请选择扫描方法"},model:{value:t.ruleForm.active_scanning_Methods,callback:function(e){t.$set(t.ruleForm,"active_scanning_Methods",e)},expression:"ruleForm.active_scanning_Methods"}},[e("el-option",{attrs:{label:"默认",value:"默认"}})],1)],1),e("el-form-item",{attrs:{label:"类型",prop:"task_type"}},[e("el-select",{attrs:{placeholder:"请选择类型"},model:{value:t.ruleForm.task_type,callback:function(e){t.$set(t.ruleForm,"task_type",e)},expression:"ruleForm.task_type"}},[e("el-option",{attrs:{label:"按需",value:"按需"}}),e("el-option",{attrs:{label:"调度",value:"调度"}})],1)],1),e("el-form-item",{attrs:{label:"调度时间",required:""}},[e("el-col",{attrs:{span:11}},[e("el-form-item",{attrs:{prop:"date1"}},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy/MM/dd"},model:{value:t.ruleForm.date1,callback:function(e){t.$set(t.ruleForm,"date1",e)},expression:"ruleForm.date1"}})],1)],1),e("el-col",{staticClass:"line",attrs:{span:2}},[t._v("-")]),e("el-col",{attrs:{span:11}},[e("el-form-item",{attrs:{prop:"date2"}},[e("el-time-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"选择时间","value-format":"hh:mm:ss"},model:{value:t.ruleForm.date2,callback:function(e){t.$set(t.ruleForm,"date2",e)},expression:"ruleForm.date2"}})],1)],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm",t.ruleForm)}}},[t._v("修改")])],1)],1)],1)],1)},ar=[],sr={props:{tableData:{type:Array,default:()=>[]}},data(){return{options:[],Data:this.tableData,id:this.$route.query.task_id-1,ruleForm:{task_id:0,task_name:"",task_describe:"",task_target:"",active_scanning_Methods:"",task_type:"",scheduling_time:"",create_time:"",last_change_time:"",task_status:"",task_progress:0,date1:"",date2:""},rules:{task_name:[{required:!0,message:"请输入组件名称",trigger:"blur"}],class:[{required:!0,message:"请选择端口范围",trigger:"change"}],scan_method:[{required:!0,message:"请选择扫描方法",trigger:"change"}],target:[{required:!0,message:"请选择测试目标",trigger:"change"}],desc:[{required:!0,message:"请填写组件描述",trigger:"blur"}],date1:[{required:!0,message:"请选择日期",trigger:"change"}],date2:[{required:!0,message:"请选择时间",trigger:"change"}]},form:{}}},methods:{Goback(){this.$router.push("/task/index")},submitForm(t,e){this.$refs[t].validate((t=>{if(!t)return console.log("error submit!!"),!1;this.$emit("ChangeTask",e),alert("submit!")})),this.Goback()},getoptions(){this.ddata=this.$store.state.TargetData,console.log(this.$store.state.TargetData),this.ddata.forEach((t=>{this.options.push({lable:t.target_name,value:t.target_name})}))}},created(){this.getoptions(),this.ruleForm=this.tableData[this.id]}},lr=sr,rr=(0,u.A)(lr,er,ar,!1,null,"7c4f6c80",null),ir=rr.exports,or=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 编辑目标 ")],1)]),e("el-header"),e("el-header"),e("div",{staticClass:"wrapper"},[e("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{width:"1300px"},attrs:{model:t.ruleForm,rules:t.rules,"label-width":"200px"}},[e("el-form-item",{attrs:{label:"组件名称",prop:"name"}},[e("el-input",{attrs:{disabled:!0},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),e("el-form-item",{attrs:{label:"组件描述",prop:"description"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.description,callback:function(e){t.$set(t.ruleForm,"description",e)},expression:"ruleForm.description"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm",t.ruleForm)}}},[t._v("修改")])],1)],1)],1)],1)},nr=[],cr={data(){return{Data:[],ruleForm:[],id:this.$route.query.index}},methods:{Goback(){this.$router.push("/target/index")},async gettarget(){let t=await this.$api.GetTarget();this.Data=t.data.data,this.ruleForm=this.Data[this.id],console.log(this.ruleForm)},submitForm(t,e){console.log(e),this.$refs[t].validate((t=>{if(!t)return console.log("error submit!!"),!1;this.$emit("targetedit",e),alert("submit!")})),this.Goback()}},created(){this.gettarget()}},ur=cr,dr=(0,u.A)(ur,or,nr,!1,null,"b0600570",null),pr=dr.exports,hr=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[t._v(" 目标（"+t._s(t.total)+"个） ")])]),e("div",{staticClass:"wrapper"},[e("el-container",[e("el-main",[[e("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"true",data:t.Data,height:"590",border:""}},[e("el-table-column",{attrs:{prop:"id",label:"CVEID",width:"150",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"summary",label:"漏洞描述",width:"600",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"impactScore",label:"严重级别",width:"100",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"cvss",label:"CVSS评分",width:"100",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"cwe",label:"CWE标识",width:"250",align:"center"}}),e("el-table-column",{attrs:{prop:"published",label:"漏洞发布时间",width:"250",align:"center"}}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.CveDetail(a.$index,a.row)}}},[t._v("详情")])]}}])})],1)]],2)],1),e("div",{staticClass:"pagination"},[e("Pagination",{attrs:{total:t.total},on:{CurrentChange:t.CurrentChange}})],1)],1)])},mr=[],fr={components:{Pagination:Ka},props:{tableData:{type:Array,default:()=>[]}},data(){return{total:241770,Data:[],page:1}},methods:{CurrentChange(t){console.log("頁嗎",t),this.cveList(t),this.page=t},async cveList(t){let e=Math.ceil(t/100),a=await this.$api.GetCves({column:e});this.Data=a.data.data.slice(10*(t-1),10*t),console.log("侧石",this.Data,t,a)},CveDetail(t,e){console.log(t,e),console.log(e),this.showdetail(e)},showdetail(t){this.$router.push({path:"/resource/resourcedetail",query:{index:t}})}},created(){this.cveList(1),console.log("what???")}},vr=fr,gr=(0,u.A)(vr,hr,mr,!1,null,"f741016e",null),_r=gr.exports,br=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 漏洞资源详情 ")],1)]),e("div",{staticClass:"wrapper"},[e("el-descriptions",{attrs:{column:"1",border:""}},[e("el-descriptions-item",{attrs:{labelStyle:"width: 125px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("名称")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.data.id)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("严重级别")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.data.impactScore)+" ")])]),e("el-descriptions-item",{attrs:{contentStyle:{width:"1000px"}}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("描述")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.data.summary)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("CVSS评分")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.data.cvss)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("披露时间")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.data.published)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("发布者")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.data.cvssSource)+" ")])]),e("el-descriptions-item",{attrs:{contentStyle:""}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("参考链接")]),e("div",{staticClass:"fontClass"},[e("a",{attrs:{href:t.reference_url}},[t._v(t._s(t.reference_url))])])])],1)],1)])},Cr=[],yr={data(){return{data:[],reference_url:""}},methods:{Goback(){this.$router.push("/resource/index")},detail_init(){this.data=this.$route.query.index,this.reference_url=this.$route.query.index.references[0]}},created(){this.detail_init()}},wr=yr,kr=(0,u.A)(wr,br,Cr,!1,null,"0405f743",null),xr=kr.exports,Dr=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[t._v(" 端口扫描策略（"+t._s(t.total)+"个） ")])]),e("div",{staticClass:"wrapper"},[e("el-container",[e("el-header",[e("el-row",{staticStyle:{"text-align":"right"}},[e("el-button",{staticClass:"detailed",attrs:{type:"primary"},on:{click:t.CreateNewPL}},[t._v(" 新增策略 ")]),e("el-select",{staticStyle:{padding:"20px"},attrs:{placeholder:"排序"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),e("el-main",[[e("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"true",data:t.Data,height:"590",border:""}},[e("el-table-column",{attrs:{prop:"name",label:"端口名称",width:"350",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"description",label:"端口描述",width:"600",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"impactScore",label:"端口合计",width:"100",align:"center","show-overflow-tooltip":"true"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.tcp_ports_cnt+e.row.udp_ports_cnt)+" ")]}}])}),e("el-table-column",{attrs:{prop:"tcp_ports_cnt",label:"TCP数量",width:"100",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"udp_ports_cnt",label:"UDP数量",width:"100",align:"center"}}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.StrategyDetail(a.$index,a.row)}}},[t._v("详情")]),e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.StrategyEdit(a.$index,a.row)}}},[t._v("编辑")]),e("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(e){return t.StrategyDelete(a.$index,a.row)}}},[t._v("删除 ")])]}}])})],1)]],2)],1),e("div",{staticClass:"pagination"},[e("Pagination",{attrs:{total:t.total},on:{CurrentChange:t.CurrentChange}})],1)],1)])},$r=[],Fr={components:{Pagination:Ka},data(){return{total:0,Data:[],page:1}},methods:{CreateNewPL(){this.$router.push("/strategy/addstrategy")},CurrentChange(t){console.log("頁嗎",t),this.strategyList(t),this.page=t},async strategyList(t){let e=await this.$api.GetPorts();this.Data=e.data.data.slice(10*(t-1),10*t),console.log("侧石",this.Data,t,e),this.total=e.data.data.length},StrategyDetail(t,e){console.log(t,e),console.log(e),this.showdetail(e)},showdetail(t){this.$router.push({path:"/strategy/strategydetail",query:{index:t}})},StrategyEdit(t,e){console.log(t,e),this.$router.push({path:"/strategy/strategyedit",query:{index:e}})},StrategyDelete(t,e){console.log(t,e),console.log(e.name),this.$confirm("确定删除当前端口扫描策略?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.deleteStrategy(e.name)})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},async deleteStrategy(t){let e=await this.$api.DeletePortList({name:t});console.log("删除--------",e.data),200==e.data.status&&this.$message({type:"success",message:"删除成功!"}),this.strategyList(1)}},created(){this.strategyList(1),console.log("what???")}},Sr=Fr,Tr=(0,u.A)(Sr,Dr,$r,!1,null,"6c668c6a",null),Ar=Tr.exports,Gr=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 新增端口扫描策略 ")],1)]),e("el-header"),e("el-header"),e("div",{staticClass:"wrapper"},[e("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{width:"1000px"},attrs:{model:t.ruleForm,rules:t.rules,options:t.options,"label-width":"200px"}},[e("el-form-item",{attrs:{label:"名称",prop:"name"}},[e("el-input",{model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),e("el-form-item",{attrs:{label:"描述",prop:"description"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.description,callback:function(e){t.$set(t.ruleForm,"description",e)},expression:"ruleForm.description"}})],1),e("el-form-item",{attrs:{label:"tcp端口列表",prop:"tcp_ports"}},[e("el-input",{attrs:{type:"textarea",placeholder:"格式形如：1,2,5-10,12,14-16..."},model:{value:t.ruleForm.tcp_ports,callback:function(e){t.$set(t.ruleForm,"tcp_ports",e)},expression:"ruleForm.tcp_ports"}})],1),e("el-form-item",{attrs:{label:"udp端口列表",prop:"udp_ports"}},[e("el-input",{attrs:{type:"textarea",placeholder:"格式形如：1,2,5-10,12,14-16..."},model:{value:t.ruleForm.udp_ports,callback:function(e){t.$set(t.ruleForm,"udp_ports",e)},expression:"ruleForm.udp_ports"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm",t.ruleForm)}}},[t._v("创建")]),e("el-button",{on:{click:function(e){return t.resetForm("ruleForm")}}},[t._v("重置")])],1)],1)],1)],1)},Pr=[],qr={data(){return{ruleForm:{name:"",description:"",tcp_ports:"",udp_ports:""},rules:{name:[{required:!0,message:"请输入策略名称",trigger:"blur"}],description:[{required:!0,message:"请填写策略描述",trigger:"blur"}]},form:{}}},methods:{Goback(){this.$router.push("/strategy/index")},submitForm(t,e){console.log(new Date),this.$refs[t].validate((t=>{if(!t)return console.log("error submit!!"),!1;this.$emit("Inserttopl",e),alert("submit!")})),this.Goback()},resetForm(t){this.$refs[t].resetFields()}},created(){console.log("chaungjian")}},Lr=qr,Er=(0,u.A)(Lr,Gr,Pr,!1,null,"459aa1d3",null),Mr=Er.exports,zr=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 编辑目标 ")],1)]),e("el-header"),e("el-header"),e("div",{staticClass:"wrapper"},[e("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{width:"1300px"},attrs:{model:t.ruleForm,rules:t.rules,"label-width":"200px"}},[e("el-form-item",{attrs:{label:"端口扫描策略名称",prop:"name"}},[e("el-input",{attrs:{disabled:!0},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),e("el-form-item",{attrs:{label:"端口扫描策略描述",prop:"description"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.description,callback:function(e){t.$set(t.ruleForm,"description",e)},expression:"ruleForm.description"}})],1),e("el-form-item",{attrs:{label:"端口扫描策略tcp端口",prop:"description"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.tcp_ports,callback:function(e){t.$set(t.ruleForm,"tcp_ports",e)},expression:"ruleForm.tcp_ports"}})],1),e("el-form-item",{attrs:{label:"端口扫描策略udp端口",prop:"description"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.udp_ports,callback:function(e){t.$set(t.ruleForm,"udp_ports",e)},expression:"ruleForm.udp_ports"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm",t.ruleForm)}}},[t._v("修改")])],1)],1)],1)],1)},Ir=[],Or={data(){return{data:[],ruleForm:[]}},methods:{Goback(){this.$router.push("/strategy/index")},submitForm(t,e){console.log(e),this.$refs[t].validate((t=>{if(!t)return console.log("error submit!!"),!1;this.$emit("strategyedit",e),alert("submit!")})),this.Goback()},init(){this.ruleForm=this.$route.query.index}},created(){this.init()}},jr=Or,Nr=(0,u.A)(jr,zr,Ir,!1,null,"50c56eb2",null),Br=Nr.exports,Rr=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 端口扫描策略详情 ")],1)]),e("div",{staticClass:"wrapper"},[e("el-descriptions",{attrs:{column:"1",border:""}},[e("el-descriptions-item",{attrs:{labelStyle:"width: 125px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("名称")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.data.name)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("详情")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.data.description)+" ")])]),e("el-descriptions-item",{attrs:{contentStyle:{width:"1000px"}}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("tcp端口")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.data.tcp_ports)+" ")])]),e("el-descriptions-item",{attrs:{contentStyle:{width:"1000px"}}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("tcp端口数量")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.data.tcp_ports_cnt)+" ")])]),e("el-descriptions-item",[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("udp端口")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.data.udp_ports)+" ")])]),e("el-descriptions-item",{attrs:{contentStyle:{width:"1000px"}}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("udp端口数量")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(t.data.udp_ports_cnt)+" ")])])],1)],1)])},Ur=[],Hr={data(){return{data:[],reference_url:""}},methods:{Goback(){this.$router.push("/strategy/index")},detail_init(){this.data=this.$route.query.index}},created(){this.detail_init()}},Vr=Hr,Qr=(0,u.A)(Vr,Rr,Ur,!1,null,"2e68daae",null),Jr=Qr.exports,Yr=function(){var t=this,e=t._self._c;return e("div",[e("router-view")],1)},Kr=[],Wr={data(){return{}},methods:{}},Xr=Wr,Zr=(0,u.A)(Xr,Yr,Kr,!1,null,null,null),ti=Zr.exports,ei={},ai=(0,u.A)(ei,ca,ua,!1,null,null,null),si=ai.exports,li=function(){var t=this,e=t._self._c;return e("div",[e("router-view")],1)},ri=[],ii={},oi=ii,ni=(0,u.A)(oi,li,ri,!1,null,null,null),ci=ni.exports,ui=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[t._v(" 指纹库（"+t._s(t.total)+"个） ")])]),e("div",{staticClass:"wrapper"},[e("el-container",[e("el-main",[[e("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"true",data:t.Data,height:"590",border:""}},[e("el-table-column",{attrs:{prop:"name",label:"指纹文件名称",width:"200",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"keyword",label:"指纹文件类型",width:"200",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"length",label:"指纹文件大小",width:"200",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"uploadDate",label:"指纹文件上传时间",width:"300",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.FPDetail(a.$index,a.row)}}},[t._v("详情")])]}}])})],1)]],2)],1),e("div",{staticClass:"pagination"},[e("Pagination",{attrs:{total:t.total},on:{CurrentChange:t.CurrentChange}})],1)],1)])},di=[],pi={components:{Pagination:Ka},props:{tableData:{type:Array,default:()=>[]}},data(){return{total:0,Data:[],page:1,id:[]}},methods:{CurrentChange(t){console.log("頁嗎",t),this.FPList(t),this.page=t},async FPList(t){let e=await this.$api.GetFPS();this.Data=e.data.data.slice(10*(t-1),10*t),this.id=e.data.id,this.total=e.data.data.length,console.log("侧石",this.Data,t,e)},FPDetail(t,e){console.log(t,e),console.log(t),this.showdetail(this.id[t],e.name)},showdetail(t,e){this.$router.push({path:"/fingerprints/detail",query:{index:t,name:e}})}},created(){this.FPList(1),console.log("what???")}},hi=pi,mi=(0,u.A)(hi,ui,di,!1,null,"94cfbc70",null),fi=mi.exports,vi=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[e("el-button",{staticClass:"detailed",attrs:{type:"text"},on:{click:t.Goback}},[e("h3",[t._v(" ← 返回 ")])]),t._v(" 指纹资源详情 ")],1)]),e("div",{staticClass:"wrapper"},[e("el-header",[e("el-row",[e("el-descriptions",{attrs:{column:"1",border:""}},[e("el-descriptions-item",{attrs:{labelStyle:"width: 125px"}},[e("span",{staticClass:"fontClass",attrs:{slot:"label"},slot:"label"},[t._v("指纹库名称")]),e("div",{staticClass:"fontClass"},[t._v(" "+t._s(this.$route.query.name)+" ")])])],1)],1)],1),e("el-input",{attrs:{type:"textarea",rows:35},model:{value:this.data,callback:function(e){t.$set(this,"data",e)},expression:"this.data"}})],1)])},gi=[],_i=a(18349),bi=a.n(_i),Ci=a(62320),yi=a.n(Ci),wi={data(){return{data:[],index:[],xml_show:[]}},methods:{Goback(){this.$router.push("/fingerprints/index")},detail_init(){this.id=this.$route.query.index,this.get_data(this.id)},async get_data(t){let e=await this.$api.GetFPSFile({id:t});console.log(e);const a=e.data.data;let s=bi().decode(a);this.data=s,this.xml_show=yi().xml(this.data)}},created(){this.detail_init()}},ki=wi,xi=(0,u.A)(ki,vi,gi,!1,null,"bf9a22e2",null),Di=xi.exports,$i=function(){var t=this,e=t._self._c;return e("div",[e("router-view")],1)},Fi=[],Si={},Ti=Si,Ai=(0,u.A)(Ti,$i,Fi,!1,null,null,null),Gi=Ai.exports,Pi=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[e("h3",[t._v(" 指纹库（"+t._s(t.total)+"个） ")])]),e("div",{staticClass:"wrapper"},[e("el-container",[e("el-main",[[e("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"true",data:t.Data,height:"590",border:""}},[e("el-table-column",{attrs:{prop:"name",label:"POC名称",width:"400",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"appName",label:"应用名称",width:"200",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"appVersion",label:"应用对应版本",width:"170",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{prop:"desc",label:"描述",width:"600",align:"center","show-overflow-tooltip":"true"}}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.FPDetail(a.$index,a.row)}}},[t._v("详情")])]}}])})],1)]],2)],1),e("div",{staticClass:"pagination"},[e("Pagination",{attrs:{total:t.total},on:{CurrentChange:t.CurrentChange}})],1)],1)])},qi=[],Li={components:{Pagination:Ka},props:{tableData:{type:Array,default:()=>[]}},data(){return{total:0,Data:[],page:1,id:[]}},methods:{CurrentChange(t){console.log("頁嗎",t),this.POCList(t),this.page=t},async POCList(t){let e=await this.$api.GetPOC();this.Data=e.data.data.slice(10*(t-1),10*t);for(let a of this.Data)a.name=a.name.replace(/'/g,""),a.appName=a.appName.replace(/'/g,""),a.appVersion=a.appVersion.replace(/'/g,""),a.desc=a.desc.replace(/'/g,"");this.id=e.data.id,this.total=e.data.data.length,console.log("侧石",this.Data,t,e)},FPDetail(t,e){console.log(t,e),console.log(t),this.showdetail(this.id[t],e.filename)},showdetail(t,e){this.$router.push({path:"/fingerprints/detail",query:{index:t,name:e}})}},created(){this.POCList(1),console.log("what???")}},Ei=Li,Mi=(0,u.A)(Ei,Pi,qi,!1,null,"b6788c2a",null),zi=Mi.exports;const Ii=()=>a.e(351).then(a.bind(a,4351));s["default"].use(da.A);const Oi=[{path:"/",component:Ta,children:[{path:"/",name:"home",component:Ba},{path:"/elements",name:"elements",component:Ii,children:[{path:"all",name:ts,component:ts},{path:"change",name:ps,component:ps}]},{path:"/target",name:"target",component:is,children:[{path:"index",name:_s,component:_s},{path:"addtarget",name:tl,component:tl},{path:"targetdetail",name:il,component:il},{path:"targetedit",name:pr,component:pr}]},{path:"/task",name:"task",component:xs,children:[{path:"index",name:_l,component:_l},{path:"addtask",name:xl,component:xl},{path:"taskdetail",name:pl,component:pl},{path:"taskchange",name:ir,component:ir}]},{path:"/result",name:"result",component:As,children:[{path:"index",name:Al,component:Al},{path:"resultdetail",name:Ml,component:Ml,children:[{path:"taskoverview",name:Bl,component:Bl},{path:"assetstatistics",name:Jl,component:Jl},{path:"hostvulnerability",name:tr,component:tr}]}]},{path:"/pocmethod",name:"pocmethod",component:ti,children:[{path:"index",name:si,component:si}]},{path:"/strategy",name:"strategy",component:Js,children:[{path:"index",name:Ar,component:Ar},{path:"addstrategy",name:Mr,component:Mr},{path:"strategyedit",name:Br,component:Br},{path:"strategydetail",name:Jr,component:Jr}]},{path:"/resource",name:"resource",component:Bs,children:[{path:"index",name:_r,component:_r},{path:"resourcedetail",name:xr,component:xr}]},{path:"/manage",name:"manage",component:Ms},{path:"/fingerprints",name:"fingerprints",component:ci,children:[{path:"index",name:fi,component:fi},{path:"detail",name:Di,component:Di}]},{path:"/pocview",name:"pocview",component:Gi,children:[{path:"index",name:zi,component:zi}]}]},{path:"/login",name:"login",component:Ea}],ji=new da.A({mode:"history",historyApiFallback:!0,routes:Oi});var Ni=ji,Bi=a(98355);const Ri={elementList:"/api/elements/elementsList",search:"/api/elements/search",deleteElements:"/api/elements/deleteElements",targetList:"/api/target/targetList",GetTarget:"/api/get_targets",GetPorts:"/api/get_port_lists",GetAliveMethods:"/api/get_alive_scan_methods",CreateTarget:"/api/create_target",DeleteTarget:"/api/delete_target",UpdateTarget:"/api/update_target",GetResult:"/api/get_result",GetTask:"/api/get_tasks",GetCves:"/api/get_cves",GetActiveMethods:"/api/get_alive_scan_methods",CreatePortList:"/api/create_port_list",DeletePortList:"/api/delete_port_list",UpdatePortList:"/api/update_port_list",CreateTask:"/api/create_task",StartTask:"/api/start_task",DeleteTask:"/api/delete_task",UpdataTask:"/api/update_task",QueryTask:"/api/query_task",GetFPS:"/api/get_fps_file",GetFPSFile:"/api/get_fps_by_id",GetPOC:"/api/get_pocs"};var Ui=Ri;const Hi={elementList(t){return Bi.A.get(Ui.elementList,{params:t})},search(t){return Bi.A.get(Ui.search,{params:t})},deleteElements(t){return Bi.A.get(Ui.deleteElements,{params:t})},targetList(t){return Bi.A.get(Ui.targetList,{params:t})},GetTarget(){return Bi.A.get(Ui.GetTarget)},GetPorts(){return Bi.A.get(Ui.GetPorts)},GetAliveMethods(){return Bi.A.get(Ui.GetAliveMethods)},CreateTarget(t){return(0,Bi.A)({url:Ui.CreateTarget,method:"post",data:t})},DeleteTarget(t){return Bi.A.get(Ui.DeleteTarget,{params:t})},UpdateTarget(t){return(0,Bi.A)({url:Ui.UpdateTarget,method:"post",data:t})},GetResult(t){return Bi.A.get(Ui.GetResult,{params:t})},GetTask(){return Bi.A.get(Ui.GetTask)},GetCves(t){return Bi.A.get(Ui.GetCves,{params:t})},GetActiveMethods(){return Bi.A.get(Ui.GetActiveMethods)},CreatePortList(t){return(0,Bi.A)({url:Ui.CreatePortList,method:"post",data:t})},DeletePortList(t){return Bi.A.get(Ui.DeletePortList,{params:t})},UpdatePortList(t){return(0,Bi.A)({url:Ui.UpdatePortList,method:"post",data:t})},StartTask(t){return Bi.A.get(Ui.StartTask,{params:t})},CreateTask(t){return(0,Bi.A)({url:Ui.CreateTask,method:"post",data:t})},DeleteTask(t){return Bi.A.get(Ui.DeleteTask,{params:t})},QueryTask(t){return Bi.A.get(Ui.QueryTask,{params:t})},GetFPS(){return Bi.A.get(Ui.GetFPS)},GetFPSFile(t){return Bi.A.get(Ui.GetFPSFile,{params:t})},GetPOC(){return Bi.A.get(Ui.GetPOC)}};var Vi=Hi,Qi=a(93518);s["default"].use(Qi.Ay);var Ji=new Qi.Ay.Store({state:{pathName:"",currDbSource:{},currJobData:{},DbSource:[],TargetData:[],TaskData:[]},mutations:{savePath(t,e){t.pathName=e},saveCurrDbSource(t,e){t.currDbSource=e},saveCurrJobData(t,e){t.currJobData=e},saveDbSource(t,e){t.DbSource=e},saveTargetData(t,e){t.TargetData=e},saveTaskData(t,e){t.TaskData=e}}}),Yi=a(19122),Ki=a.n(Yi),Wi=a(2582),Xi=a(81109);a(13765);s["default"].prototype.$api=Vi,s["default"].config.productionTip=!1,s["default"].directive("highlight",(function(t){let e=t.querySelectorAll("pre code");e.forEach((t=>{Xi.A.highlightBlock(t)}))})),new s["default"]({render:t=>t(p),router:Ni,store:Ji,qs:Ki(),Base64:Wi.o4}).$mount("#app")},42634:function(){}},e={};function a(s){var l=e[s];if(void 0!==l)return l.exports;var r=e[s]={id:s,loaded:!1,exports:{}};return t[s].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=t,function(){var t=[];a.O=function(e,s,l,r){if(!s){var i=1/0;for(u=0;u<t.length;u++){s=t[u][0],l=t[u][1],r=t[u][2];for(var o=!0,n=0;n<s.length;n++)(!1&r||i>=r)&&Object.keys(a.O).every((function(t){return a.O[t](s[n])}))?s.splice(n--,1):(o=!1,r<i&&(i=r));if(o){t.splice(u--,1);var c=l();void 0!==c&&(e=c)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[s,l,r]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){a.f={},a.e=function(t){return Promise.all(Object.keys(a.f).reduce((function(e,s){return a.f[s](t,e),e}),[]))}}(),function(){a.u=function(t){return"js/"+t+".0c359e6e.js"}}(),function(){a.miniCssF=function(t){}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="vue-project:";a.l=function(s,l,r,i){if(t[s])t[s].push(l);else{var o,n;if(void 0!==r)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==s||d.getAttribute("data-webpack")==e+r){o=d;break}}o||(n=!0,o=document.createElement("script"),o.charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.setAttribute("data-webpack",e+r),o.src=s),t[s]=[l];var p=function(e,a){o.onerror=o.onload=null,clearTimeout(h);var l=t[s];if(delete t[s],o.parentNode&&o.parentNode.removeChild(o),l&&l.forEach((function(t){return t(a)})),e)return e(a)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=p.bind(null,o.onerror),o.onload=p.bind(null,o.onload),n&&document.head.appendChild(o)}}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){a.p="/"}(),function(){var t={524:0};a.f.j=function(e,s){var l=a.o(t,e)?t[e]:void 0;if(0!==l)if(l)s.push(l[2]);else{var r=new Promise((function(a,s){l=t[e]=[a,s]}));s.push(l[2]=r);var i=a.p+a.u(e),o=new Error,n=function(s){if(a.o(t,e)&&(l=t[e],0!==l&&(t[e]=void 0),l)){var r=s&&("load"===s.type?"missing":s.type),i=s&&s.target&&s.target.src;o.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",o.name="ChunkLoadError",o.type=r,o.request=i,l[1](o)}};a.l(i,n,"chunk-"+e,e)}},a.O.j=function(e){return 0===t[e]};var e=function(e,s){var l,r,i=s[0],o=s[1],n=s[2],c=0;if(i.some((function(e){return 0!==t[e]}))){for(l in o)a.o(o,l)&&(a.m[l]=o[l]);if(n)var u=n(a)}for(e&&e(s);c<i.length;c++)r=i[c],a.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return a.O(u)},s=self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=a.O(void 0,[504],(function(){return a(8677)}));s=a.O(s)})();
//# sourceMappingURL=app.eea7e1e9.js.map